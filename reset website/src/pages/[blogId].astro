---
import Layout from "@layouts/layout.astro";
import { getBlogs, getBlogDetail } from "../library/microcms";
import { Image } from "astro:assets";

export const prerender = true;
// 詳細記事ページの全パスを取得
export async function getStaticPaths() {
  const response = await getBlogs({ fields: ["id"] });
  return response.contents.map((content) => ({
    params: {
      blogId: content.id,
    },
  }));
}

// 記事の詳細情報を取得
const { blogId } = Astro.params;
const blog = await getBlogDetail(blogId as string);

const articles = blog.article;

console.log(articles);



// let {
//   html,
//   images,
//   text,
// } = Astro.props;

// articles.forEach((article) => {
//   if (article.fieldId === "rich_editor") {
//     html = article.rich_editor;
//   } else if (article.fieldId === "image") {
//     images = Object.values(article.image);
//     console.log(images);

//   } else {
//     text = article.text;
//   }
// });
---

<Layout>
  <main>
    <h1 class="title">{blog.title}</h1>
    <p class="publishedAt">{blog.publishedAt}</p>
    <p>{blog.category.id}</p>
    <!-- <div class="post" set:html={blog.article[0].rich_editor}></div> -->
    <div>
      <!-- <p>{text}</p>
      <div class="post" set:html={html} />
      <p>{text}</p>
      <img
        src={images.url}
        alt=""
        height={images.height}
        width={images.width}
      /> -->
    </div>
  </main>
</Layout>
